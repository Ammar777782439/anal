```GO 
package main

import "fmt"

// تعريف Struct يمثل قاعدة جدار الحماية لمكون معين
type FirewallRule struct {
    Component         string   // المكون
    Protocol          string   // البروتوكول
    Ports             []int    // المنافذ
    InboundRules      string   // قواعد الوارد (Inbound)
    OutboundRules     string   // قواعد الصادر (Outbound)
   
}

func main() {
    // إنشاء قائمة بالقواعد حسب الجدول
    rules := []FirewallRule{
        {
            Component:        "لوحة التحكم",
            Protocol:         "HTTPS",
            Ports:            []int{443},
            InboundRules:     "من شبكات الإدارة فقط",
            OutboundRules:    "إلى واجهة API (443)",
          
        },
        {
            Component:        "واجهة API",
            Protocol:         "gRPC / HTTPS",
            Ports:            []int{50051, 443},
            InboundRules:     "من لوحة التحكم (443)",
            OutboundRules:    "إلى الخادم المركزي (50051)",
           
        },
        {
            Component:        "الخادم المركزي",
            Protocol:         "gRPC",
            Ports:            []int{50051},
            InboundRules:     "من واجهة API والوكلاء",
            OutboundRules:    "إلى الوكلاء ودليل الوكلاء",
           
        },
        {
            Component:        "الوكلاء",
            Protocol:         "gRPC",
            Ports:            []int{50051},
            InboundRules:     "من الخادم المركزي فقط",
            OutboundRules:    "إلى الخادم المركزي (50051)",
           
        },
    }

    // عرض القواعد
    for _, rule := range rules {
        fmt.Printf("المكون: %s\n", rule.Component)
        fmt.Printf("البروتوكول: %s\n", rule.Protocol)
        fmt.Printf("المنافذ: %v\n", rule.Ports)
        fmt.Printf("قواعد الوارد: %s\n", rule.InboundRules)
        fmt.Printf("قواعد الصادر: %s\n", rule.OutboundRules)
        fmt.Printf("مستوى الحساسية: %s\n\n", rule.SensitivityLevel)
    }
}

```




```mermaid
sequenceDiagram
    participant Client as "العميل"
    participant gRPC_Server as "السيرفر"
    participant DB as "قاعدة البيانات"
    participant Agent as "الوكيل"

    Client->>gRPC_Server: 1. إرسال طلب عبر gRPC
    note right of Client: CreateRequest(command_type, command_payload)
    
    gRPC_Server->>DB: 2. حفظ الطلب الأولي
    note left of DB: INSERT INTO requests (status: 'pending')
    
    DB-->>gRPC_Server: request_id
    
    gRPC_Server->>DB: 3. البحث عن وكيل مناسب
    note left of DB: SELECT agent_id FROM agents WHERE status = 'active'
    
    DB-->>gRPC_Server: agent_id
    
    gRPC_Server->>DB: 4. تحديث الطلب وتعيين الوكيل
    note left of DB: UPDATE requests SET assigned_agent_id = ?
    
    gRPC_Server-->>Client: 5. إرجاع تأكيد فوري للعميل
    note right of Client: تم استلام طلبك بنجاح، هذا هو رقم المتابعة: (request_id)
    
    gRPC_Server->>Agent: 6. إرسال الأمر للوكيل للتنفيذ
    note right of Agent: هذه العملية تتم بشكل غير متزامن (asynchronously)
```